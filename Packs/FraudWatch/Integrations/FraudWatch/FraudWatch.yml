category: Data Enrichment & Threat Intelligence
commonfields:
  id: FraudWatch
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: API Token (fill in password field)
  displaypassword: API Token
  name: credentials
  type: 9
  required: false
  hiddenusername: true
- display: Server URL
  name: base_url
  type: 0
  required: false
  additionalinfo: URL of the server.
  defaultvalue: https://www.phishportal.com
- display: Brand
  name: brand
  type: 0
  required: false
  additionalinfo: Fetch incidents which corresponds to the given brand. Returns error
    if brand does not exist. List of existing brands can be retrieved by 'fraudwatch-brands-list'
    command.
- display: Status
  name: status
  type: 15
  required: false
  options:
  - active
  - new
  - monitor
  - reactive
  - onhold
  - closed
  - closedmonitor
  - rejected
  - duplicate
  additionalinfo: Fetch incidents which corresponds to the given status.
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: "1"
  display: Incidents Fetch Interval
  name: incidentFetchInterval
  required: false
  type: 19
- defaultvalue: 1 day
  display: First fetch timestamp
  name: first_fetch
  required: false
  type: 0
  additionalinfo: 'format: (<number> <time unit>, e.g., 12 hours, 1 day). Due to limitations
    in FraudWatch API, first fetch timestamp can be at most 1 day.'
- defaultvalue: '50'
  name: max_fetch
  required: false
  type: 0
  display: Maximum Incidents To Fetch
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Manage incidents via the Fraudwatch API. FraudWatch International provides
  a fully managed Enterprise Digital Brand Protection Suite, including online brand
  management & monitoring as well as providing other brand protection solutions that
  protect organizations and their customers around the world against online brand-related
  abuse.
display: FraudWatch
name: FraudWatch
script:
  commands:
  - arguments:
    - description: Retrieve incidents which corresponds to the given brand. Returns
        error if brand does not exist. List of existing brands can be retrieved by
        'fraudwatch-brands-list' command.
      name: brand
    - auto: PREDEFINED
      description: Retrieve incidents which corresponds to the given status.
      name: status
      predefined:
      - active
      - new
      - monitor
      - reactive
      - onhold
      - closed
      - closedmonitor
      - rejected
      - duplicate
    - description: Total number of Incidents in a page. Maximum number is 200.
      name: limit
      defaultValue: '20'
    - description: Retrieve incidents by the given page number.
      name: page
    - description: "Retrieve alerts that their date opened is higher or equal to 'from'\
        \ value. Supports ISO and time range (<number> <time unit>, e.g., 12 hours,\
        \ 7 days) formats. If 'to' argument is not given, default value for 'to' is\
        \ current time."
      name: from
    - description: "Retrieve alerts that their date opened is lower or equal to 'to'\
        \ value. Supports ISO and time range (<number> <time unit>, e.g., 12 hours,\
        \ 7 days) formats. If 'from' argument is not given, default value for 'from'\
        \ is 12 months before 'to'."
      name: to
    description: Get list of incidents from FraudWatch service.
    name: fraudwatch-incidents-list
    outputs:
    - contextPath: FraudWatch.Incident.identifier
      description: Identifier of the incident.
      type: String
    - contextPath: FraudWatch.Incident.reference_id
      description: Reference ID of the incident.
      type: String
    - contextPath: FraudWatch.Incident.url
      description: Main URL associated to the incident.
      type: String
    - contextPath: FraudWatch.Incident.status
      description: Status of the incident.
      type: String
    - contextPath: FraudWatch.Incident.type
      description: Type of the incident.
      type: String
    - contextPath: FraudWatch.Incident.brand
      description: Brand of the incident.
      type: String
    - contextPath: FraudWatch.Incident.client
      description: Client.
      type: String
    - contextPath: FraudWatch.Incident.content_ip
      description: Content IP.
      type: String
    - contextPath: FraudWatch.Incident.host
      description: The incident's host.
      type: String
    - contextPath: FraudWatch.Incident.host_country
      description: The country of the host.
      type: String
    - contextPath: FraudWatch.Incident.host_timezone
      description: The timezone of the host.
      type: String
    - contextPath: FraudWatch.Incident.created_by
      description: Who created the incident.
      type: String
    - contextPath: FraudWatch.Incident.discovered_by
      description: Who discovered the incident.
      type: String
    - contextPath: FraudWatch.Incident.current_duration
      description: Current duration of the incident.
      type: String
    - contextPath: FraudWatch.Incident.active_duration
      description: Current active duration of the incident.
      type: Unknown
    - contextPath: FraudWatch.Incident.date_opened
      description: The date incident was opened.
      type: Date
    - contextPath: FraudWatch.Incident.date_closed
      description: The date incident was closed.
      type: Date
    - contextPath: FraudWatch.Incident.additional_urls
      description: Additional URLs associated to the incidents.
      type: String
    - contextPath: FraudWatch.Incident.link
      description: URL to the incident page in FraudWatch User Interface.
      type: String
  - arguments:
    - description: The brand associated to the reported incident. Returns error if
        brand does not exist. List of existing brands can be retrieved by 'fraudwatch-brands-list'
        command.
      name: brand
      required: true
    - auto: PREDEFINED
      description: The type of the incident to be associated to the reported incident.
        Returns error if brand does not exist.
      name: type
      predefined:
      - phishing
      - vishing
      - brand_abuse
      - malware
      - social_media_brand_abuse
      - mobile_app_unauthorized
      - pac_file
      - pharming
      - messaging
      - dmarc_email_server
      required: true
    - description: Reference ID to be associated to the reported incident. Should
        be unique. Reference ID can be used later to retrieve specific incident by
        its reference id.
      name: reference_id
    - description: Primary URL of the reported incident.
      name: primary_url
      required: true
    - description: Comma separated list of additional urls in addition to 'primary_url'
        to be associated with the reported incident.
      isArray: true
      name: urls
    - description: Evidence to be added (such as logs, etc...) to the reported incident.
      name: evidence
    - description: Additional instructions to be added for FraudWatch Security Team
        about the reported incident.
      name: instructions
    description: Report an incident to FraudWatch service.
    name: fraudwatch-incident-report
    outputs:
    - contextPath: FraudWatch.Incident.identifier
      description: Identifier of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.reference_id
      description: Reference ID of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.url
      description: Main URL associated to the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.status
      description: Status of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.type
      description: Type of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.brand
      description: Brand of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.client
      description: Client.
      type: String
    - contextPath: FraudWatch.Incident.content_ip
      description: Content IP.
      type: String
    - contextPath: FraudWatch.Incident.host
      description: The new reported incident's host.
      type: String
    - contextPath: FraudWatch.Incident.host_country
      description: The country of the host.
      type: String
    - contextPath: FraudWatch.Incident.host_timezone
      description: The timezone of the host.
      type: String
    - contextPath: FraudWatch.Incident.created_by
      description: Who created the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.discovered_by
      description: Who discovered the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.current_duration
      description: Current duration of the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.active_duration
      description: Current active duration of the new reported incident.
      type: Unknown
    - contextPath: FraudWatch.Incident.date_opened
      description: The date the new reported incident was opened. Has value of the
        day incident was reported.
      type: Date
    - contextPath: FraudWatch.Incident.date_closed
      description: The date new reported incident was closed. Starts empty, as incident
        was just created.
      type: Date
    - contextPath: FraudWatch.Incident.additional_urls
      description: Additional URLs associated to the new reported incident.
      type: String
    - contextPath: FraudWatch.Incident.link
      description: Link to the new reported incident page in FraudWatch User Interface.
      type: String
  - arguments:
    - description: The ID of the incident to be updated. Incident ID is the 'identifier'
        field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    - description: Updates the incident associated to the 'incident_id' with brand
        given. Returns error if brand does not exist. List of existing brands can
        be retrieved by 'fraudwatch-brands-list' command.
      name: brand
    - description: Updates the incident associated to the 'incident_id' with reference
        ID given. Reference ID should be unique, and can be used by command 'fraudwatch-incident-get-by-identifier'
        to retrieve specific incident's details by its reference id.
      name: reference_id
    - description: Evidence to be added (such as logs, etc...) to the reported incident.
      name: evidence
    - description: Updates the incident associated to the 'incident_id' with additional
        instructions for FraudWatch Security Team.
      name: instructions
    description: Updates the incident associated to the 'incident_id' with given arguments
      values.
    name: fraudwatch-incident-update
  - arguments:
    - description: The ID of the incident to be retrieve its details. Incident ID
        is the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
    - description: Reference id of the incident to be retrieve its details. If more
        than one incident is associated to 'reference_id',returns the details of the
        incident with the latest date opened. Reference ID is the 'reference_id' field
        returned by command 'fraudwatch-incidents-list'.
      name: reference_id
    description: Gets an incident from FraudWatch service by its reference ID or incident
      ID. Exactly one argument of 'reference_id' and 'incident_id' should be given.
    name: fraudwatch-incident-get-by-identifier
    outputs:
    - contextPath: FraudWatch.Incident.identifier
      description: Identifier of the incident.
      type: String
    - contextPath: FraudWatch.Incident.reference_id
      description: Reference ID of the incident.
      type: String
    - contextPath: FraudWatch.Incident.url
      description: Main URL associated to the incident.
      type: String
    - contextPath: FraudWatch.Incident.status
      description: Status of the incident.
      type: String
    - contextPath: FraudWatch.Incident.type
      description: Type of the incident.
      type: String
    - contextPath: FraudWatch.Incident.brand
      description: Brand of the incident.
      type: String
    - contextPath: FraudWatch.Incident.client
      description: Client.
      type: String
    - contextPath: FraudWatch.Incident.content_ip
      description: Content IP.
      type: String
    - contextPath: FraudWatch.Incident.host
      description: The incident's host.
      type: String
    - contextPath: FraudWatch.Incident.host_country
      description: The country of the host.
      type: String
    - contextPath: FraudWatch.Incident.host_timezone
      description: The timezone of the host.
      type: String
    - contextPath: FraudWatch.Incident.created_by
      description: Who created the incident.
      type: String
    - contextPath: FraudWatch.Incident.discovered_by
      description: Who discovered the incident.
      type: String
    - contextPath: FraudWatch.Incident.current_duration
      description: Current duration of the incident.
      type: String
    - contextPath: FraudWatch.Incident.active_duration
      description: Current active duration of the incident.
      type: Unknown
    - contextPath: FraudWatch.Incident.date_opened
      description: The date incident was opened.
      type: Date
    - contextPath: FraudWatch.Incident.date_closed
      description: The date incident was closed.
      type: Date
    - contextPath: FraudWatch.Incident.additional_urls
      description: Additional URLs associated to the incident.
      type: String
    - contextPath: FraudWatch.Incident.link
      description: Link to the incident page in FraudWatch User Interface.
      type: String
  - arguments:
    - description: The ID of the incident to retrieve its forensic data. Incident
        ID is the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    description: Gets forensic data of an incident associated to the given incident
      ID.
    name: fraudwatch-incident-forensic-get
    outputs:
    - contextPath: FraudWatch.IncidentForensicData.host_provider.name
      description: Name of the host provider.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_provider.country
      description: Country of the host provider.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_nameservers
      description: Name of the host servers.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_domain_registrar.name
      description: Host domain registrar name.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_domain_registrar.email
      description: Host domain registrar email.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_domain_registrar.country
      description: Host domain registrar country.
      type: String
    - contextPath: FraudWatch.IncidentForensicData.host_site_owner
      description: Host site owner.
      type: Unknown
    - contextPath: FraudWatch.IncidentForensicData.host_site_admin
      description: Host site admin.
      type: Unknown
    - contextPath: FraudWatch.IncidentForensicData.host_domain_admin
      description: Host domain admin.
      type: Unknown
    - contextPath: FraudWatch.IncidentForensicData.host_ip_providier
      description: Host IP provider.
      type: Unknown
    - contextPath: FraudWatch.IncidentForensicData.identifier
      description: Identifier of the incident.
      type: String
  - arguments:
    - description: The ID of the incident to retrieve its email contacts data. Incident
        ID is the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    - description: Maximum number of contact emails in a page. Maximum number is 200.
      defaultValue: '20'
      name: limit
    - description: Retrieve contact emails by the given page number.
      name: page
    description: Provides contact emails for the incident associated to the given
      incident ID.
    name: fraudwatch-incident-contact-emails-list
    outputs:
    - contextPath: FraudWatch.IncidentContacts.noteId
      description: Note ID of the email.
      type: String
    - contextPath: FraudWatch.IncidentContacts.subject
      description: Subject of the email.
      type: String
    - contextPath: FraudWatch.IncidentContacts.creator
      description: The creator of the email.
      type: String
    - contextPath: FraudWatch.IncidentContacts.content
      description: The content of the email.
      type: String
    - contextPath: FraudWatch.IncidentContacts.date
      description: The date of the email.
      type: Date
  - arguments:
    - description: The ID of the incident to add a message to its email contacts.
        Incident ID is the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    - description: Content of the message.
      name: message_content
      required: true
    description: Add a new message to be associated to the incident associated to
      the given incident ID.
    name: fraudwatch-incident-messages-add
  - arguments:
    - description: The ID of the incident to add additional urls to. Incident ID is
        the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    - description: Comma separated list. Additional URLs to be added to the incident
        associated to 'incident_id'.
      name: urls
      required: true
      isArray: true
    description: Adds additional URLs to the incident associated to the given incident
      ID. Fails if one of the urls given already exists.
    name: fraudwatch-incident-urls-add
    outputs:
    - contextPath: FraudWatch.IncidentUrls.success
      description: Whether the URLs were added successfully.
      type: String
    - contextPath: FraudWatch.IncidentUrls.new_urls
      description: The new URLs that have been added.
      type: String
  - arguments:
    - description: The ID of the incident to add a file attachment to. Incident ID
        is the 'identifier' field returned by command 'fraudwatch-incidents-list'.
      name: incident_id
      required: true
    - description: Entry id in Demisto of the attachment to be added to the incident.
      name: entry_id
      required: true
    description: Adds a new file attachment to the incident associated to the given
      incident ID.
    name: fraudwatch-incident-attachment-upload
  - arguments:
    - description: Total number of brands in a page. Maximum number is 100, minimum
        number is 20.
      name: limit
      defaultValue: '20'
    - description: Retrieve brands by the given page number.
      name: page
    description: Gets a list of brands from FraudWatch service.
    name: fraudwatch-brands-list
    outputs:
    - contextPath: FraudWatch.Brand.client
      description: The client.
      type: String
    - contextPath: FraudWatch.Brand.alternate business name
      description: Alternative business name.
      type: String
    - contextPath: FraudWatch.Brand.name
      description: The name of the brand.
      type: String
    - contextPath: FraudWatch.Brand.active
      description: Wether brand is active or not.
      type: Boolean
    - contextPath: FraudWatch.Brand.services.name
      description: The name of the service.
      type: String
    - contextPath: FraudWatch.Brand.services.action
      description: The action of the service.
      type: String
  dockerimage: demisto/python3:3.9.1.15759
  isFetchSamples: true
  isfetch: true
  runonce: false
  script: ''
  subtype: python3
  type: python
fromversion: 5.0.0
tests:
- FraudWatch-Test
defaultmapperin: FraudWatch-mapper